<header class="docs-header">
      <docs-breadcrumb></docs-breadcrumb>

      
  <!-- Page title -->
  <div class="docs-page-title">
    <h1 tabindex="-1">分层注入器</h1>
    <a class="docs-github-links" target="_blank" href="https://github.com/angular/angular/edit/main/adev/src/content/guide/di/hierarchical-dependency-injection.md" title="Edit this page" aria-label="Edit this page">
      <!-- Pencil -->
      <docs-icon role="presentation">edit</docs-icon>
    </a>
  </div>
    </header>
    <p>Angular 中的注入器有一些规则，你可以利用这些规则在你的应用中实现可注入对象的期望可见性。通过理解这些规则，你可以确定是在应用级别、组件中还是指令中声明提供者。</p>
<p>你使用 Angular 构建的应用可能会变得非常庞大，管理这种复杂性的一种方法是将应用拆分成一个定义良好的组件树。</p>
<p>你的页面中可能存在一些区域，它们以完全独立于应用其余部分的方式工作，并拥有自己本地的服务副本和所需的其他依赖项。这些应用区域使用的一些服务可能会与其他应用部分或组件树中更靠上的父组件共享，而其他依赖项则应该是私有的。</p>
<p>通过分层依赖注入，你可以隔离应用的各个部分，并为它们提供不与应用其余部分共享的私有依赖项，或者让父组件仅与其子组件共享某些依赖项，而不与组件树的其余部分共享，等等。分层依赖注入使你能够在应用的不同部分之间仅在需要时共享依赖项。</p>

  <h2 id="types-of-injector-hierarchies">
    <a href="#types-of-injector-hierarchies" class="docs-anchor" tabindex="-1" aria-label="Link to Types of injector hierarchies">注入器分层的类型</a>
  </h2>
  <p>Angular 有两个注入器分层：</p>

  <div class="docs-table docs-scroll-track-transparent">
    <table>
      <thead>
        <tr>
<th align="left">注入器分层</th>
<th align="left">详情</th>
</tr>

      </thead>
      <tbody>
        <tr>
<td align="left"><code>EnvironmentInjector</code> 分层结构</td>
<td align="left">在此分层结构中使用 <code>@Injectable()</code> 或 <code>ApplicationConfig</code> 中的 <code>providers</code> 数组配置一个 <code>EnvironmentInjector</code>。</td>
</tr>
<tr>
<td align="left"><code>ElementInjector</code> 分层结构</td>
<td align="left">在每个 DOM 元素上隐式创建。除非你在 <code>@Directive()</code> 或 <code>@Component()</code> 的 <code>providers</code> 属性中配置它，否则 <code>ElementInjector</code> 默认是空的。</td>
</tr>

      </tbody>
    </table>
  </div>
  
    <div class="docs-callout docs-callout-helpful">
      <h3>基于 NgModule 的应用</h3>
      <p>对于基于 <code>NgModule</code> 的应用，你可以使用 <code>@NgModule()</code> 或 <code>@Injectable()</code> 注解，通过 <code>ModuleInjector</code> 分层结构提供依赖项。</p>

    </div>
    
  <h3 id="environmentinjector">
    <a href="#environmentinjector" class="docs-anchor" tabindex="-1" aria-label="Link to <code>EnvironmentInjector</code>"><code>EnvironmentInjector</code></a>
  </h3>
  <p><code>EnvironmentInjector</code> 可以通过以下两种方式之一进行配置：</p>

  <ul class="docs-list">
    <li><code>@Injectable()</code> 的 <code>providedIn</code> 属性，用于引用 <code>root</code> 或 <code>platform</code></li>
<li><code>ApplicationConfig</code> 的 <code>providers</code> 数组</li>

  </ul>
  
    <div class="docs-callout docs-callout-helpful">
      <h3>摇树优化和 @Injectable()</h3>
      <p>使用 <code>@Injectable()</code> 的 <code>providedIn</code> 属性比使用 <code>ApplicationConfig</code> 的 <code>providers</code> 数组更可取。使用 <code>@Injectable()</code> 的 <code>providedIn</code>，优化工具可以执行摇树优化，从而移除你的应用未使用的服务。这会减小捆绑包大小。</p>
<p>摇树优化对于库尤其有用，因为使用该库的应用可能不需要注入它。</p>

    </div>
    <p><code>EnvironmentInjector</code> 由 <code>ApplicationConfig.providers</code> 配置。</p>
<p>使用 <code>@Injectable()</code> 的 <code>providedIn</code> 提供服务，如下所示：</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> { Injectable } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '@angular/core'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Injectable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">({</span></span><span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  providedIn: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'root'</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">  // &lt;--provides this service in the root EnvironmentInjector</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">})</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> ItemService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">  name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 'telephone'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
    </pre>
  </div><p><code>@Injectable()</code> 装饰器标识一个服务类。<code>providedIn</code> 属性配置一个特定的 <code>EnvironmentInjector</code>，这里是 <code>root</code>，这使得该服务在 <code>root</code> <code>EnvironmentInjector</code> 中可用。</p>

  <h3 id="moduleinjector">
    <a href="#moduleinjector" class="docs-anchor" tabindex="-1" aria-label="Link to ModuleInjector">ModuleInjector</a>
  </h3>
  <p>对于基于 <code>NgModule</code> 的应用，ModuleInjector 可以通过以下两种方式之一进行配置：</p>

  <ul class="docs-list">
    <li><code>@Injectable()</code> 的 <code>providedIn</code> 属性，用于引用 <code>root</code> 或 <code>platform</code></li>
<li><code>@NgModule()</code> 的 <code>providers</code> 数组</li>

  </ul>
  <p><code>ModuleInjector</code> 由 <code>@NgModule.providers</code> 和 <code>NgModule.imports</code> 属性配置。<code>ModuleInjector</code> 是通过递归跟踪 <code>NgModule.imports</code> 可以访问的所有 providers 数组的扁平化结果。</p>
<p>当惰性加载其他 <code>@NgModules</code> 时，会创建子 <code>ModuleInjector</code> 分层结构。</p>

  <h3 id="platform-injector">
    <a href="#platform-injector" class="docs-anchor" tabindex="-1" aria-label="Link to Platform injector">平台注入器</a>
  </h3>
  <p>在 <code>root</code> 之上有两个更多的注入器，一个额外的 <code>EnvironmentInjector</code> 和 <code>NullInjector()</code>。</p>
<p>考虑 Angular 如何使用 <code>main.ts</code> 中的以下内容引导应用：</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">bootstrapApplication</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(AppComponent, appConfig);</span></span></code></pre>
    </pre>
  </div><p><code>bootstrapApplication()</code> 方法创建一个平台注入器的子注入器，该子注入器由 <code>ApplicationConfig</code> 实例配置。这就是 <code>root</code> <code>EnvironmentInjector</code>。</p>
<p><code>platformBrowserDynamic()</code> 方法创建一个由 <code>PlatformModule</code> 配置的注入器，其中包含特定于平台的依赖项。这允许多个应用共享一个平台配置。例如，无论你运行多少个应用，浏览器都只有一个 URL 栏。你可以通过使用 <code>platformBrowser()</code> 函数提供 <code>extraProviders</code>，在平台级别配置额外的特定于平台的提供者。</p>
<p>分层结构中的下一个父注入器是 <code>NullInjector()</code>，它是树的顶部。如果你在树中向上查找服务直到 <code>NullInjector()</code>，你将会收到一个错误，除非你使用了 <code>@Optional()</code>，因为最终，一切都止于 <code>NullInjector()</code>，它会返回一个错误，或者在使用 <code>@Optional()</code> 的情况下，返回 <code>null</code>。有关 <code>@Optional()</code> 的更多信息，请参阅本指南的 <a href="#optional"><code>@Optional()</code> 部分</a>。</p>
<p>下图表示 <code>root</code> <code>EnvironmentInjector</code> 与其父注入器之间的关系，如前几段所述。</p>
<svg aria-roledescription="stateDiagram" role="graphics-document document" viewBox="0 0 232 548" style="max-width: 232px;" class="statediagram" xmlns="http://www.w3.org/2000/svg" width="100%" id="mermaid-generated-diagram"><style>#mermaid-generated-diagram{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}@keyframes edge-animation-frame{from{stroke-dashoffset:0;}}@keyframes dash{to{stroke-dashoffset:0;}}#mermaid-generated-diagram .edge-animation-slow{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 50s linear infinite;stroke-linecap:round;}#mermaid-generated-diagram .edge-animation-fast{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 20s linear infinite;stroke-linecap:round;}#mermaid-generated-diagram .error-icon{fill:hsl(220.5882352941, 100%, 98.3333333333%);}#mermaid-generated-diagram .error-text{fill:rgb(8.5000000002, 5.7500000001, 0);stroke:rgb(8.5000000002, 5.7500000001, 0);}#mermaid-generated-diagram .edge-thickness-normal{stroke-width:1px;}#mermaid-generated-diagram .edge-thickness-thick{stroke-width:3.5px;}#mermaid-generated-diagram .edge-pattern-solid{stroke-dasharray:0;}#mermaid-generated-diagram .edge-thickness-invisible{stroke-width:0;fill:none;}#mermaid-generated-diagram .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-generated-diagram .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-generated-diagram .marker{fill:#0b0b0b;stroke:#0b0b0b;}#mermaid-generated-diagram .marker.cross{stroke:#0b0b0b;}#mermaid-generated-diagram svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-generated-diagram p{margin:0;}#mermaid-generated-diagram defs #statediagram-barbEnd{fill:#0b0b0b;stroke:#0b0b0b;}#mermaid-generated-diagram g.stateGroup text{fill:hsl(40.5882352941, 60%, 83.3333333333%);stroke:none;font-size:10px;}#mermaid-generated-diagram g.stateGroup text{fill:#333;stroke:none;font-size:10px;}#mermaid-generated-diagram g.stateGroup .state-title{font-weight:bolder;fill:#333;}#mermaid-generated-diagram g.stateGroup rect{fill:#fff4dd;stroke:hsl(40.5882352941, 60%, 83.3333333333%);}#mermaid-generated-diagram g.stateGroup line{stroke:#0b0b0b;stroke-width:1;}#mermaid-generated-diagram .transition{stroke:#0b0b0b;stroke-width:1;fill:none;}#mermaid-generated-diagram .stateGroup .composit{fill:#f4f4f4;border-bottom:1px;}#mermaid-generated-diagram .stateGroup .alt-composit{fill:#e0e0e0;border-bottom:1px;}#mermaid-generated-diagram .state-note{stroke:hsl(52.6829268293, 60%, 73.9215686275%);fill:#fff5ad;}#mermaid-generated-diagram .state-note text{fill:#333;stroke:none;font-size:10px;}#mermaid-generated-diagram .stateLabel .box{stroke:none;stroke-width:0;fill:#fff4dd;opacity:0.5;}#mermaid-generated-diagram .edgeLabel .label rect{fill:#fff4dd;opacity:0.5;}#mermaid-generated-diagram .edgeLabel{background-color:hsl(-79.4117647059, 100%, 93.3333333333%);text-align:center;}#mermaid-generated-diagram .edgeLabel p{background-color:hsl(-79.4117647059, 100%, 93.3333333333%);}#mermaid-generated-diagram .edgeLabel rect{opacity:0.5;background-color:hsl(-79.4117647059, 100%, 93.3333333333%);fill:hsl(-79.4117647059, 100%, 93.3333333333%);}#mermaid-generated-diagram .edgeLabel .label text{fill:#333;}#mermaid-generated-diagram .label div .edgeLabel{color:#333;}#mermaid-generated-diagram .stateLabel text{fill:#333;font-size:10px;font-weight:bold;}#mermaid-generated-diagram .node circle.state-start{fill:#0b0b0b;stroke:#0b0b0b;}#mermaid-generated-diagram .node .fork-join{fill:#0b0b0b;stroke:#0b0b0b;}#mermaid-generated-diagram .node circle.state-end{fill:hsl(40.5882352941, 60%, 83.3333333333%);stroke:#f4f4f4;stroke-width:1.5;}#mermaid-generated-diagram .end-state-inner{fill:#f4f4f4;stroke-width:1.5;}#mermaid-generated-diagram .node rect{fill:#fff4dd;stroke:hsl(40.5882352941, 60%, 83.3333333333%);stroke-width:1px;}#mermaid-generated-diagram .node polygon{fill:#fff4dd;stroke:hsl(40.5882352941, 60%, 83.3333333333%);stroke-width:1px;}#mermaid-generated-diagram #statediagram-barbEnd{fill:#0b0b0b;}#mermaid-generated-diagram .statediagram-cluster rect{fill:#fff4dd;stroke:hsl(40.5882352941, 60%, 83.3333333333%);stroke-width:1px;}#mermaid-generated-diagram .cluster-label,#mermaid-generated-diagram .nodeLabel{color:#333;}#mermaid-generated-diagram .statediagram-cluster rect.outer{rx:5px;ry:5px;}#mermaid-generated-diagram .statediagram-state .divider{stroke:hsl(40.5882352941, 60%, 83.3333333333%);}#mermaid-generated-diagram .statediagram-state .title-state{rx:5px;ry:5px;}#mermaid-generated-diagram .statediagram-cluster.statediagram-cluster .inner{fill:#f4f4f4;}#mermaid-generated-diagram .statediagram-cluster.statediagram-cluster-alt .inner{fill:hsl(220.5882352941, 100%, 98.3333333333%);}#mermaid-generated-diagram .statediagram-cluster .inner{rx:0;ry:0;}#mermaid-generated-diagram .statediagram-state rect.basic{rx:5px;ry:5px;}#mermaid-generated-diagram .statediagram-state rect.divider{stroke-dasharray:10,10;fill:hsl(220.5882352941, 100%, 98.3333333333%);}#mermaid-generated-diagram .note-edge{stroke-dasharray:5;}#mermaid-generated-diagram .statediagram-note rect{fill:#fff5ad;stroke:hsl(52.6829268293, 60%, 73.9215686275%);stroke-width:1px;rx:0;ry:0;}#mermaid-generated-diagram .statediagram-note rect{fill:#fff5ad;stroke:hsl(52.6829268293, 60%, 73.9215686275%);stroke-width:1px;rx:0;ry:0;}#mermaid-generated-diagram .statediagram-note text{fill:#333;}#mermaid-generated-diagram .statediagram-note .nodeLabel{color:#333;}#mermaid-generated-diagram .statediagram .edgeLabel{color:red;}#mermaid-generated-diagram #dependencyStart,#mermaid-generated-diagram #dependencyEnd{fill:#0b0b0b;stroke:#0b0b0b;stroke-width:1;}#mermaid-generated-diagram .statediagramTitleText{text-anchor:middle;font-size:18px;fill:#333;}#mermaid-generated-diagram :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style><g><defs><marker orient="auto" markerUnits="userSpaceOnUse" markerHeight="14" markerWidth="20" refY="7" refX="19" id="mermaid-generated-diagram_stateDiagram-barbEnd"><path d="M 19,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#mermaid-generated-diagram_stateDiagram-barbEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid transition" id="edge0" d="M116,356L116,351.833C116,347.667,116,339.333,116,331C116,322.667,116,314.333,116,310.167L116,306"></path><path marker-end="url(#mermaid-generated-diagram_stateDiagram-barbEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid transition" id="edge1" d="M116,170L116,165.833C116,161.667,116,153.333,116,145C116,136.667,116,128.333,116,124.167L116,120"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(116, 238)" id="state-elementInjector-1" class="node  statediagram-state"><rect height="136" width="216" y="-68" x="-108" ry="5" rx="5" style="" class="basic label-container"></rect><g transform="translate(-100, -60)" style="" class="label"><rect></rect><foreignObject height="120" width="200"><div style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>EnvironmentInjector<br>(configured by Angular)<br>has special things like DomSanitizer =&gt; providedIn 'platform'</p></span></div></foreignObject></g></g><g transform="translate(116, 448)" id="state-rootInjector-0" class="node  statediagram-state"><rect height="184" width="216" y="-92" x="-108" ry="5" rx="5" style="" class="basic label-container"></rect><g transform="translate(-100, -84)" style="" class="label"><rect></rect><foreignObject height="168" width="200"><div style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>root EnvironmentInjector<br>(configured by AppConfig)<br>has things for your app =&gt; bootstrapApplication(..., AppConfig)</p></span></div></foreignObject></g></g><g transform="translate(116, 64)" id="state-nullInjector-1" class="node  statediagram-state"><rect height="112" width="216" y="-56" x="-108" ry="5" rx="5" style="" class="basic label-container"></rect><g transform="translate(-100, -48)" style="" class="label"><rect></rect><foreignObject height="96" width="200"><div style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>NullInjector<br>always throws an error unless<br>you use @Optional()</p></span></div></foreignObject></g></g></g></g></g></svg><p>虽然名称 <code>root</code> 是一个特殊的别名，但其他 <code>EnvironmentInjector</code> 分层结构没有别名。每当创建动态加载的组件时，你都可以选择创建 <code>EnvironmentInjector</code> 分层结构，例如使用 Router，它将创建子 <code>EnvironmentInjector</code> 分层结构。</p>
<p>所有请求都转发到根注入器，无论你是使用传递给 <code>bootstrapApplication()</code> 方法的 <code>ApplicationConfig</code> 实例配置它，还是在你自己的服务中向 <code>root</code> 注册了所有提供者。</p>

    <div class="docs-callout docs-callout-helpful">
      <h3>@Injectable() 与 ApplicationConfig</h3>
      <p>如果你在 <code>bootstrapApplication</code> 的 <code>ApplicationConfig</code> 中配置了一个应用范围的提供者，它将覆盖在 <code>@Injectable()</code> 元数据中为 <code>root</code> 配置的提供者。你可以这样做来配置一个与多个应用共享的服务的非默认提供者。</p>
<p>这是一个示例，其中组件路由器配置通过在 <code>ApplicationConfig</code> 的 <code>providers</code> 列表中列出其提供者，包含了非默认的 <a href="guide/routing#location-strategy">位置策略</a>。</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">providers</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: [</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  { provide: LocationStrategy, useClass: HashLocationStrategy }</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]</span></span></code></pre>
    </pre>
  </div><p>对于基于 <code>NgModule</code> 的应用，在 <code>AppModule</code> 的 <code>providers</code> 中配置应用范围的提供者。</p>

    </div>
    
  <h3 id="elementinjector">
    <a href="#elementinjector" class="docs-anchor" tabindex="-1" aria-label="Link to <code>ElementInjector</code>"><code>ElementInjector</code></a>
  </h3>
  <p>Angular 为每个 DOM 元素隐式地创建 <code>ElementInjector</code> 分层结构。</p>
<p>在 <code>@Component()</code> 装饰器中使用其 <code>providers</code> 或 <code>viewProviders</code> 属性提供服务会配置一个 <code>ElementInjector</code>。例如，以下 <code>TestComponent</code> 通过如下方式提供服务来配置 <code>ElementInjector</code>：</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Component</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">({</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  …</span></span><span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  providers: [{ provide: ItemService, useValue: { name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'lamp'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> } }]</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">})</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> TestComponent</span></span></code></pre>
    </pre>
  </div>
    <div class="docs-alert docs-alert-helpful">
    <p><strong>提示：</strong> 请参阅<a href="#resolution-rules">解析规则</a>部分，以了解 <code>EnvironmentInjector</code> 树、<code>ModuleInjector</code> 和 <code>ElementInjector</code> 树之间的关系。</p>

    </div>
    <p>当你在组件中提供服务时，该服务通过该组件实例的 <code>ElementInjector</code> 可用。根据<a href="#resolution-rules">解析规则</a>部分中描述的可见性规则，它也可能在子组件/指令中可见。</p>
<p>当组件实例被销毁时，该服务实例也会被销毁。</p>

  <h4 id="directive-and-component">
    <a href="#directive-and-component" class="docs-anchor" tabindex="-1" aria-label="Link to <code>@Directive()</code> and <code>@Component()</code>"><code>@Directive()</code> 和 <code>@Component()</code></a>
  </h4>
  <p>组件是一种特殊类型的指令，这意味着正如 <code>@Directive()</code> 具有 <code>providers</code> 属性一样，<code>@Component()</code> 也是如此。这意味着指令以及组件都可以使用 <code>providers</code> 属性配置提供者。当你使用 <code>providers</code> 属性为组件或指令配置提供者时，该提供者属于该组件或指令的 <code>ElementInjector</code>。同一元素上的组件和指令共享一个注入器。</p>

  <h2 id="resolution-rules">
    <a href="#resolution-rules" class="docs-anchor" tabindex="-1" aria-label="Link to Resolution rules">解析规则</a>
  </h2>
  <p>当为组件/指令解析令牌时，Angular 分两个阶段解析它：</p>

    <ol class="docs-ordered-list">
      <li>相对于 <code>ElementInjector</code> 分层结构中的父注入器。</li>
<li>相对于 <code>EnvironmentInjector</code> 分层结构中的父注入器。</li>

    </ol>
    <p>当组件声明依赖时，Angular 尝试使用自己的 <code>ElementInjector</code> 来满足该依赖。
如果组件的注入器缺少提供者，它会将请求传递给父组件的 <code>ElementInjector</code>。</p>
<p>请求会一直向上转发，直到 Angular 找到可以处理该请求的注入器，或者耗尽了祖先 <code>ElementInjector</code> 分层结构。</p>
<p>如果 Angular 在任何 <code>ElementInjector</code> 分层结构中都找不到提供者，它会回到请求的起始元素，并在 <code>EnvironmentInjector</code> 分层结构中查找。
如果 Angular 仍然找不到提供者，它会抛出一个错误。</p>
<p>如果你在不同的层级为同一个 DI 令牌注册了提供者，Angular 遇到的第一个提供者就是它用来求解依赖的提供者。
例如，如果在一个需要服务的组件中本地注册了一个提供者，
Angular 就不会再查找同一服务的另一个提供者。</p>

    <div class="docs-alert docs-alert-helpful">
    <p><strong>提示：</strong> 对于基于 <code>NgModule</code> 的应用，如果 Angular 在 <code>ElementInjector</code> 分层结构中找不到提供者，它将搜索 <code>ModuleInjector</code> 分层结构。</p>

    </div>
    
  <h2 id="resolution-modifiers">
    <a href="#resolution-modifiers" class="docs-anchor" tabindex="-1" aria-label="Link to Resolution modifiers">解析修饰符</a>
  </h2>
  <p>Angular 的解析行为可以使用 <code>optional</code>、<code>self</code>、<code>skipSelf</code> 和 <code>host</code> 进行修改。
从 <code>@angular/core</code> 导入它们中的每一个，并在注入服务时在 <code>inject</code> 配置中使用。</p>

  <h3 id="types-of-modifiers">
    <a href="#types-of-modifiers" class="docs-anchor" tabindex="-1" aria-label="Link to Types of modifiers">修饰符的类型</a>
  </h3>
  <p>解析修饰符分为三类：</p>

  <ul class="docs-list">
    <li>如果 Angular 找不到你要查找的内容，该怎么办？那就是 <code>optional</code></li>
<li>从哪里开始查找？那就是 <code>skipSelf</code></li>
<li>在哪里停止查找？<code>host</code> 和 <code>self</code></li>

  </ul>
  <p>默认情况下，Angular 总是从当前的 <code>Injector</code> 开始，并一直向上搜索。
修饰符允许你更改起始位置（即<em>self</em> 位置）和结束位置。</p>
<p>此外，你可以组合除以下之外的所有修饰符：</p>

  <ul class="docs-list">
    <li><code>host</code> 和 <code>self</code></li>
<li><code>skipSelf</code> 和 <code>self</code>。</li>

  </ul>
  
  <h3 id="optional">
    <a href="#optional" class="docs-anchor" tabindex="-1" aria-label="Link to <code>optional</code>"><code>optional</code></a>
  </h3>
  <p><code>optional</code> 允许 Angular 将你注入的服务视为可选的。
这样，如果在运行时无法求解，Angular 会将该服务求解为 <code>null</code>，而不是抛出错误。
在以下范例中，服务 <code>OptionalService</code> 未在服务、<code>ApplicationConfig</code>、<code>@NgModule()</code> 或组件类中提供，因此它在应用的任何地方都不可用。</p>
<div class="docs-code" header="src/app/optional/optional.component.ts">
    <div class="docs-code-header"><h3>src/app/optional/optional.component.ts</h3></div>
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> OptionalComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  public</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70"> optional</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">?</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> inject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(OptionalService, {optional: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">});</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
    </pre>
  </div>
  <h3 id="self">
    <a href="#self" class="docs-anchor" tabindex="-1" aria-label="Link to <code>self</code>"><code>self</code></a>
  </h3>
  <p>使用 <code>self</code>，以便 Angular 只查看当前组件或指令的 <code>ElementInjector</code>。</p>
<p><code>self</code> 的一个好的用例是注入一个服务，但前提是它在当前宿主元素上可用。
为了避免在这种情况下出错，请将 <code>self</code> 与 <code>optional</code> 结合使用。</p>
<p>例如，在下面的 <code>SelfNoDataComponent</code> 中，请注意作为属性注入的 <code>LeafService</code>。</p>
<div class="docs-code" header="src/app/self-no-data/self-no-data.component.ts">
    <div class="docs-code-header"><h3>src/app/self-no-data/self-no-data.component.ts</h3></div>
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Component</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">({</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  selector: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'app-self-no-data'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  templateUrl: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'./self-no-data.component.html'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  styleUrls: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'./self-no-data.component.css'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">]</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">})</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> SelfNoDataComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span class="line highlighted"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  public</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70"> leaf</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> inject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(LeafService, {optional: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, self: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">});</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
    </pre>
  </div><p>在此示例中，有一个父提供者，注入服务将返回该值；但是，使用 <code>self</code> 和 <code>optional</code> 注入服务将返回 <code>null</code>，因为 <code>self</code> 告诉注入器停止在当前宿主元素中搜索。</p>
<p>另一个示例显示了带有 <code>FlowerService</code> 提供者的组件类。
在这种情况下，注入器不会在当前的 <code>ElementInjector</code> 之外查找，因为它找到了 <code>FlowerService</code> 并返回了郁金香 <code><span class="docs-emoji">🌷</span></code>。</p>
<div class="docs-code" path="adev/src/content/examples/resolution-modifiers/src/app/self/self.component.ts" visiblelines="3,4,5,6,7,8,9,10,11" header="src/app/self/self.component.ts">
    <div class="docs-code-header"><h3>src/app/self/self.component.ts</h3></div>
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {Component, Self} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '@angular/core'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {FlowerService} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '../flower.service'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Component</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">({</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  selector: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'app-self'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  templateUrl: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'./self.component.html'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  styleUrls: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'./self.component.css'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">],</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  providers: [{provide: FlowerService, useValue: {emoji: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'🌷'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}}],</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">})</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> SelfComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  constructor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">public</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70"> flower</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> FlowerService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) {}</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// This component provides the FlowerService so the injector</span></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">// doesn't have to look further up the injector tree</span></span><span class="line"></span></code></pre>
    </pre>
  </div>
  <h3 id="skipself">
    <a href="#skipself" class="docs-anchor" tabindex="-1" aria-label="Link to <code>skipSelf</code>"><code>skipSelf</code></a>
  </h3>
  <p><code>skipSelf</code> 与 <code>self</code> 相反。
使用 <code>skipSelf</code>，Angular 会在其父 <code>ElementInjector</code> 中开始搜索服务，而不是在当前的 <code>ElementInjector</code> 中。
因此，如果父 <code>ElementInjector</code> 对 <code>emoji</code> 使用 fern <code><span class="docs-emoji">🌿</span></code> 值，但你在组件的 <code>providers</code> 数组中使用了 maple leaf <code><span class="docs-emoji">🍁</span></code>，则 Angular 将忽略 maple leaf <code><span class="docs-emoji">🍁</span></code> 并使用 fern <code><span class="docs-emoji">🌿</span></code>。</p>
<p>要在代码中看到这一点，假设以下 <code>emoji</code> 值是父组件正在使用的值，如下服务所示：</p>
<div class="docs-code" header="src/app/leaf.service.ts">
    <div class="docs-code-header"><h3>src/app/leaf.service.ts</h3></div>
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> LeafService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">  emoji</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '🌿'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
    </pre>
  </div><p>假设在子组件中，你有一个不同的值，枫叶 <code><span class="docs-emoji">🍁</span></code>，但你想使用父组件的值。
这时你就可以使用 <code>skipSelf</code>：</p>
<div class="docs-code" header="src/app/skipself/skipself.component.ts">
    <div class="docs-code-header"><h3>src/app/skipself/skipself.component.ts</h3></div>
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Component</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">({</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  selector: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'app-skipself'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  templateUrl: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'./skipself.component.html'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  styleUrls: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'./skipself.component.css'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">],</span></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">  // Angular would ignore this LeafService instance</span></span><span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  providers: [{ provide: LeafService, useValue: { emoji: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'🍁'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> } }]</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">})</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> SkipselfComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">  // Use skipSelf as inject option</span></span><span class="line highlighted"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  public</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70"> leaf</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> inject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(LeafService, {skipSelf: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">});</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
    </pre>
  </div><p>在这种情况下，你为 <code>emoji</code> 获取的值将是蕨类植物 <code><span class="docs-emoji">🌿</span></code>，而不是枫叶 <code><span class="docs-emoji">🍁</span></code>。</p>

  <h4 id="skipself-option-with-optional">
    <a href="#skipself-option-with-optional" class="docs-anchor" tabindex="-1" aria-label="Link to <code>skipSelf</code> option with <code>optional</code>">带有 <code>optional</code> 的 <code>skipSelf</code> 选项</a>
  </h4>
  <p>将 <code>skipSelf</code> 选项与 <code>optional</code> 结合使用，以防止值是 <code>null</code> 时出错。</p>
<p>在以下示例中，<code>Person</code> 服务在属性初始化期间被注入。
<code>skipSelf</code> 告诉 Angular 跳过当前的注入器，而 <code>optional</code> 将防止在 <code>Person</code> 服务为 <code>null</code> 时出错。</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> Person</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">  parent</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> inject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(Person, {optional: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, skipSelf: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">})</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
    </pre>
  </div>
  <h3 id="host">
    <a href="#host" class="docs-anchor" tabindex="-1" aria-label="Link to <code>host</code>"><code>host</code></a>
  </h3>
  <!-- TODO: Remove ambiguity between host and self. -->

<p>在搜索提供者时，<code>host</code> 允许你将组件指定为注入器树中的最后一站。</p>
<p>即使树的更上方有服务实例，Angular 也不会继续查找。
按如下方式使用 <code>host</code>：</p>
<div class="docs-code" header="src/app/host/host.component.ts">
    <div class="docs-code-header"><h3>src/app/host/host.component.ts</h3></div>
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Component</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">({</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  selector: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'app-host'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  templateUrl: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'./host.component.html'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  styleUrls: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'./host.component.css'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">],</span></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">  //  provide the service</span></span><span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  providers: [{ provide: FlowerService, useValue: { emoji: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'🌷'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> } }]</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">})</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> HostComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">  // use host when injecting the service</span></span><span class="line highlighted"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">  flower</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> inject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(FlowerService, {host: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, optional: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">});</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
    </pre>
  </div><p>由于 <code>HostComponent</code> 具有 <code>host</code> 选项，无论 <code>HostComponent</code> 的父组件可能有什么样的 <code>flower.emoji</code> 值，<code>HostComponent</code> 都将使用郁金香 <code><span class="docs-emoji">🌷</span></code>。</p>

  <h3 id="modifiers-with-constructor-injection">
    <a href="#modifiers-with-constructor-injection" class="docs-anchor" tabindex="-1" aria-label="Link to Modifiers with constructor injection">带有构造函数注入的修饰符</a>
  </h3>
  <p>与之前介绍的类似，构造函数注入的行为可以使用 <code>@Optional()</code>、<code>@Self()</code>、<code>@SkipSelf()</code> 和 <code>@Host()</code> 进行修改。</p>
<p>从 <code>@angular/core</code> 导入它们中的每一个，并在注入服务时在组件类构造函数中使用。</p>
<div class="docs-code" header="src/app/self-no-data/self-no-data.component.ts">
    <div class="docs-code-header"><h3>src/app/self-no-data/self-no-data.component.ts</h3></div>
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> SelfNoDataComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  constructor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">() @</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Optional</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">public</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70"> leaf</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">?:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> LeafService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) { }</span></span><span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
    </pre>
  </div>
  <h2 id="logical-structure-of-the-template">
    <a href="#logical-structure-of-the-template" class="docs-anchor" tabindex="-1" aria-label="Link to Logical structure of the template">模板的逻辑结构</a>
  </h2>
  <p>当你在组件类中提供服务时，服务在 <code>ElementInjector</code> 树中是可见的，这取决于你提供这些服务的位置和方式。</p>
<p>理解 Angular 模板的底层逻辑结构将为你配置服务奠定基础，进而控制它们的可视性。</p>
<p>组件在你的模板中使用，如下例所示：</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-root</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-child</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-child</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-root</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span></code></pre>
    </pre>
  </div>
    <div class="docs-alert docs-alert-helpful">
    <p><strong>提示：</strong> 通常，你在单独的文件中声明组件及其模板。
为了理解注入系统的工作原理，从组合逻辑树的角度来看待它们很有用。
术语<em>逻辑</em>将其与渲染树（即应用的 DOM 树）区分开来。
为了标记组件模板所在的位置，本指南使用 <code>&lt;#VIEW&gt;</code> 伪元素，该伪元素实际上并不存在于渲染树中，仅出于心智模型目的而存在。</p>

    </div>
    <p>以下示例说明了 <code>&lt;app-root&gt;</code> 和 <code>&lt;app-child&gt;</code> 视图树如何组合成单个逻辑树：</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-root</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">  &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">#VIEW&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-child</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">     &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">#VIEW&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       …content goes here…</span></span><span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">     &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">/#VIEW&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-child</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">  &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">/#VIEW&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-root</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span></code></pre>
    </pre>
  </div><p>当你在组件类中配置服务时，理解 <code>&lt;#VIEW&gt;</code> 划界的概念尤为重要。</p>

  <h2 id="example-providing-services-in-component">
    <a href="#example-providing-services-in-component" class="docs-anchor" tabindex="-1" aria-label="Link to Example: Providing services in <code>@Component()</code>">范例：在 <code>@Component()</code> 中提供服务</a>
  </h2>
  <p>你如何使用 <code>@Component()</code>（或 <code>@Directive()</code>）装饰器提供服务决定了它们的可视性。
以下各节演示了 <code>providers</code> 和 <code>viewProviders</code>，以及使用 <code>skipSelf</code> 和 <code>host</code> 修改服务可见性的方法。</p>
<p>组件类可以通过两种方式提供服务：</p>

  <div class="docs-table docs-scroll-track-transparent">
    <table>
      <thead>
        <tr>
<th align="left">数组</th>
<th align="left">详情</th>
</tr>

      </thead>
      <tbody>
        <tr>
<td align="left">使用 <code>providers</code> 数组</td>
<td align="left"><code>@Component({ providers: [SomeService] })</code></td>
</tr>
<tr>
<td align="left">使用 <code>viewProviders</code> 数组</td>
<td align="left"><code>@Component({ viewProviders: [SomeService] })</code></td>
</tr>

      </tbody>
    </table>
  </div>
  <p>在下面的示例中，你将看到 Angular 应用的逻辑树。
为了说明注入器如何在模板上下文中工作，逻辑树将表示应用的 HTML 结构。
例如，逻辑树将显示 <code>&lt;child-component&gt;</code> 是 <code>&lt;parent-component&gt;</code> 的直接子组件。</p>
<p>在逻辑树中，你将看到特殊的属性（Attribute）：<code>@Provide</code>、<code>@Inject</code> 和 <code>@ApplicationConfig</code>。
这些不是真实的属性（Attribute），而是为了演示底层发生了什么。</p>

  <div class="docs-table docs-scroll-track-transparent">
    <table>
      <thead>
        <tr>
<th align="left">Angular 服务属性（Attribute）</th>
<th align="left">详情</th>
</tr>

      </thead>
      <tbody>
        <tr>
<td align="left"><code>@Inject(Token)=&gt;Value</code></td>
<td align="left">如果 <code>Token</code> 在逻辑树的这个位置被注入，它的值将是 <code>Value</code>。</td>
</tr>
<tr>
<td align="left"><code>@Provide(Token=Value)</code></td>
<td align="left">表明 <code>Token</code> 在逻辑树的这个位置通过 <code>Value</code> 提供。</td>
</tr>
<tr>
<td align="left"><code>@ApplicationConfig</code></td>
<td align="left">演示了在此位置应使用回退 <code>EnvironmentInjector</code>。</td>
</tr>

      </tbody>
    </table>
  </div>
  
  <h3 id="example-app-structure">
    <a href="#example-app-structure" class="docs-anchor" tabindex="-1" aria-label="Link to Example app structure">范例应用结构</a>
  </h3>
  <p>此范例应用在 <code>root</code> 中提供了一个 <code>FlowerService</code>，其 <code>emoji</code> 值为红色芙蓉花 <code><span class="docs-emoji">🌺</span></code>。</p>
<div class="docs-code" header="src/app/flower.service.ts">
    <div class="docs-code-header"><h3>src/app/flower.service.ts</h3></div>
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Injectable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">({</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  providedIn: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'root'</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">})</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> FlowerService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">  emoji</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '🌺'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
    </pre>
  </div><p>考虑一个仅包含 <code>AppComponent</code> 和 <code>ChildComponent</code> 的应用。
最基本的渲染视图看起来会像如下嵌套的 HTML 元素一样：</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-root</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">&lt;!-- AppComponent selector --&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-child</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">&lt;!-- ChildComponent selector --&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-child</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-root</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span></code></pre>
    </pre>
  </div><p>但是，在幕后，Angular 在求解注入请求时使用如下逻辑视图表示：</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-root</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">&lt;!-- AppComponent selector --&gt;</span></span><span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">  &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">#VIEW&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-child</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">&lt;!-- ChildComponent selector --&gt;</span></span><span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">      &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">#VIEW&gt;</span></span><span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">      &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">/#VIEW&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-child</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">  &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">/#VIEW&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-root</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span></code></pre>
    </pre>
  </div><p>这里的 <code>&lt;#VIEW&gt;</code> 表示模板的一个实例。
请注意，每个组件都有自己的 <code>&lt;#VIEW&gt;</code>。</p>
<p>了解此结构可以帮助你了解如何提供和注入服务，并使你完全控制服务的可见性。</p>
<p>现在，假设 <code>&lt;app-root&gt;</code> 注入了 <code>FlowerService</code>：</p>
<div class="docs-code" header="src/app/app.component.ts">
    <div class="docs-code-header"><h3>src/app/app.component.ts</h3></div>
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> AppComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  {</span></span><span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">  flower</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> inject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(FlowerService);</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
    </pre>
  </div><p>向 <code>&lt;app-root&gt;</code> 模板添加一个绑定以可视化结果：</p>
<div class="docs-code" header="src/app/app.component.html">
    <div class="docs-code-header"><h3>src/app/app.component.html</h3></div>
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;Emoji from FlowerService: {{flower.emoji}}&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span></code></pre>
    </pre>
  </div><p>视图中的输出将是：</p>
<div class="docs-code shell">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Emoji</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> FlowerService:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 🌺</span></span></code></pre>
    </pre>
  </div><p>在逻辑树中，这将表示为如下形式：</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-root</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> @ApplicationConfig</span></span><span class="line highlighted"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">        @Inject(FlowerService)</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> flower</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">=&gt;"🌺"&gt;</span></span><span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">  &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">#VIEW&gt;</span></span><span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;Emoji from FlowerService: {{flower.emoji}} (🌺)&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-child</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">      &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">#VIEW&gt;</span></span><span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">      &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">/#VIEW&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-child</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">  &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">/#VIEW&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-root</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span></code></pre>
    </pre>
  </div><p>当 <code>&lt;app-root&gt;</code> 请求 <code>FlowerService</code> 时，注入器的任务是求解 <code>FlowerService</code> 令牌。
令牌的求解分两个阶段进行：</p>

    <ol class="docs-ordered-list">
      <li><p>注入器确定逻辑树中的起始位置和搜索的结束位置。
 注入器从起始位置开始，并在逻辑树中的每个视图级别查找令牌。
 如果找到令牌，则返回它。</p>
</li>
<li><p>如果未找到令牌，则注入器将查找最近的父 <code>EnvironmentInjector</code> 以将请求委托给它。</p>
</li>

    </ol>
    <p>在此范例中，约束条件为：</p>

    <ol class="docs-ordered-list">
      <li><p>从属于 <code>&lt;app-root&gt;</code> 的 <code>&lt;#VIEW&gt;</code> 开始，到 <code>&lt;app-root&gt;</code> 结束。</p>

  <ul class="docs-list">
    <li>通常，搜索的起点位于注入点。
  但是，在本例中，<code>&lt;app-root&gt;</code> 是一个组件。<code>@Component</code> 是特殊的，因为它们还包括自己的 <code>viewProviders</code>，这就是为什么搜索从属于 <code>&lt;app-root&gt;</code> 的 <code>&lt;#VIEW&gt;</code> 开始的原因。
  对于在同一位置匹配的指令，情况并非如此。</li>
<li>结束位置恰好与组件本身相同，因为它是此应用中最顶层的组件。</li>

  </ul>
  </li>
<li><p>当在 <code>ElementInjector</code> 层级结构中找不到注入令牌时，由 <code>ApplicationConfig</code> 提供的 <code>EnvironmentInjector</code> 充当回退注入器。</p>
</li>

    </ol>
    
  <h3 id="using-the-providers-array">
    <a href="#using-the-providers-array" class="docs-anchor" tabindex="-1" aria-label="Link to Using the <code>providers</code> array">使用 <code>providers</code> 数组</a>
  </h3>
  <p>现在，在 <code>ChildComponent</code> 类中，为 <code>FlowerService</code> 添加一个提供者，以演示后续章节中更复杂的求解规则：</p>
<div class="docs-code" header="src/app/child.component.ts">
    <div class="docs-code-header"><h3>src/app/child.component.ts</h3></div>
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Component</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">({</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  selector: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'app-child'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  templateUrl: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'./child.component.html'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  styleUrls: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'./child.component.css'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">],</span></span><span class="line highlighted"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">  // use the providers array to provide a service</span></span><span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  providers: [{ provide: FlowerService, useValue: { emoji: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'🌻'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> } }]</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">})</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> ChildComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">  // inject the service</span></span><span class="line highlighted"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">  flower</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> inject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(FlowerService);</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
    </pre>
  </div><p>现在 <code>FlowerService</code> 已在 <code>@Component()</code> 装饰器中提供，当 <code>&lt;app-child&gt;</code> 请求该服务时，注入器只需查看 <code>&lt;app-child&gt;</code> 中的 <code>ElementInjector</code> 即可。
它不必在注入器树中继续进一步搜索。</p>
<p>下一步是将绑定添加到 <code>ChildComponent</code> 模板。</p>
<div class="docs-code" header="src/app/child.component.html">
    <div class="docs-code-header"><h3>src/app/child.component.html</h3></div>
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;Emoji from FlowerService: {{flower.emoji}}&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span></code></pre>
    </pre>
  </div><p>要渲染新值，请将 <code>&lt;app-child&gt;</code> 添加到 <code>AppComponent</code> 模板的底部，以便视图也显示向日葵：</p>
<div class="docs-code shell">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Child</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Component</span></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Emoji</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> FlowerService:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 🌻</span></span></code></pre>
    </pre>
  </div><p>在逻辑树中，这表示为如下形式：</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-root</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> @ApplicationConfig</span></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">        @Inject(FlowerService)</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> flower</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">=&gt;"🌺"&gt;</span></span><span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">  &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">#VIEW&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;Emoji from FlowerService: {{flower.emoji}} (🌺)&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-child</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> @Provide(FlowerService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"🌻"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">)</span></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">               @Inject(FlowerService)</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">=&gt;"🌻"&gt; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">&lt;!-- search ends here --&gt;</span></span><span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">      &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">#VIEW&gt; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">&lt;!-- search starts here --&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">h2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;Child Component&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">h2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;Emoji from FlowerService: {{flower.emoji}} (🌻)&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">      &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">/#VIEW&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-child</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">  &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">/#VIEW&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-root</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span></code></pre>
    </pre>
  </div><p>当 <code>&lt;app-child&gt;</code> 请求 <code>FlowerService</code> 时，注入器从属于 <code>&lt;app-child&gt;</code> 的 <code>&lt;#VIEW&gt;</code> 开始搜索（包含 <code>&lt;#VIEW&gt;</code> 是因为它从 <code>@Component()</code> 注入），并以 <code>&lt;app-child&gt;</code> 结束。
在本例中，<code>FlowerService</code> 在 <code>&lt;app-child&gt;</code> 的 <code>providers</code> 数组中使用向日葵 <code><span class="docs-emoji">🌻</span></code> 求解。
注入器不必在注入器树中进一步查找。
它在找到 <code>FlowerService</code> 后立即停止，并且永远不会看到红色芙蓉花 <code><span class="docs-emoji">🌺</span></code>。</p>

  <h3 id="using-the-viewproviders-array">
    <a href="#using-the-viewproviders-array" class="docs-anchor" tabindex="-1" aria-label="Link to Using the <code>viewProviders</code> array">使用 <code>viewProviders</code> 数组</a>
  </h3>
  <p>使用 <code>viewProviders</code> 数组作为在 <code>@Component()</code> 装饰器中提供服务的另一种方式。
使用 <code>viewProviders</code> 使服务在 <code>&lt;#VIEW&gt;</code> 中可见。</p>

    <div class="docs-alert docs-alert-helpful">
    <p><strong>提示：</strong> 这些步骤与使用 <code>providers</code> 数组相同，唯一的区别是使用 <code>viewProviders</code> 数组。</p>

    </div>
    <p>有关分步说明，请继续阅读本节。
如果你可以自行建立，请跳至<a href="#visibility-of-provided-tokens">修改服务可用性</a>。</p>
<p>为了演示，我们正在构建一个 <code>AnimalService</code> 以演示 <code>viewProviders</code>。
首先，创建一个 <code>AnimalService</code>，其 <code>emoji</code> 属性为鲸鱼 <code><span class="docs-emoji">🐳</span></code>：</p>
<div class="docs-code" header="src/app/animal.service.ts">
    <div class="docs-code-header"><h3>src/app/animal.service.ts</h3></div>
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> { Injectable } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '@angular/core'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Injectable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">({</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  providedIn: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'root'</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">})</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> AnimalService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">  emoji</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '🐳'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
    </pre>
  </div><p>按照与 <code>FlowerService</code> 相同的模式，在 <code>AppComponent</code> 类中注入 <code>AnimalService</code>：</p>
<div class="docs-code" header="src/app/app.component.ts">
    <div class="docs-code-header"><h3>src/app/app.component.ts</h3></div>
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> AppComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    public</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70"> flower</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> inject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(FlowerService);</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    public</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70"> animal</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> inject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(AnimalService);</span></span><span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
    </pre>
  </div>
    <div class="docs-alert docs-alert-helpful">
    <p><strong>提示：</strong> 你可以保留所有与 <code>FlowerService</code> 相关的代码，因为它允许与 <code>AnimalService</code> 进行比较。</p>

    </div>
    <p>添加一个 <code>viewProviders</code> 数组，并在 <code>&lt;app-child&gt;</code> 类中也注入 <code>AnimalService</code>，但为 <code>emoji</code> 提供不同的值。
在这里，它的值为狗 <code><span class="docs-emoji">🐶</span></code>。</p>
<div class="docs-code" header="src/app/child.component.ts">
    <div class="docs-code-header"><h3>src/app/child.component.ts</h3></div>
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Component</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">({</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  selector: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'app-child'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  templateUrl: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'./child.component.html'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  styleUrls: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'./child.component.css'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">],</span></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">  // provide services</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  providers: [{ provide: FlowerService, useValue: { emoji: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'🌻'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> } }],</span></span><span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  viewProviders: [{ provide: AnimalService, useValue: { emoji: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'🐶'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> } }]</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">})</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> ChildComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">  // inject services</span></span><span class="line highlighted"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">  flower</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> inject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(FlowerService); </span></span><span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">  animal</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> inject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(AnimalService)</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">...</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
    </pre>
  </div><p>将绑定添加到 <code>ChildComponent</code> 和 <code>AppComponent</code> 模板。
在 <code>ChildComponent</code> 模板中，添加以下绑定：</p>
<div class="docs-code" header="src/app/child.component.html">
    <div class="docs-code-header"><h3>src/app/child.component.html</h3></div>
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;Emoji from AnimalService: {{animal.emoji}}&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span></code></pre>
    </pre>
  </div><p>此外，将相同的绑定添加到 <code>AppComponent</code> 模板：</p>
<div class="docs-code" header="src/app/app.component.html">
    <div class="docs-code-header"><h3>src/app/app.component.html</h3></div>
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;Emoji from AnimalService: {{animal.emoji}}&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;s</span></span></code></pre>
    </pre>
  </div><p>现在你应该在浏览器中看到这两个值：</p>
<div class="docs-code shell">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">AppComponent</span></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Emoji</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> AnimalService:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 🐳</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Child</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> Component</span></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Emoji</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> AnimalService:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 🐶</span></span></code></pre>
    </pre>
  </div><p>此 <code>viewProviders</code> 范例的逻辑树如下所示：</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-root</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> @ApplicationConfig</span></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">         @Inject(AnimalService)</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> animal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">=&gt;"🐳"&gt;</span></span><span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">  &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">#VIEW&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-child</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">      &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">#VIEW @Provide(AnimalService="🐶")</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            @Inject(AnimalService=&gt;"🐶")&gt;</span></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">       &lt;!-- ^^using viewProviders means AnimalService is available in &lt;#VIEW&gt;--&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">       &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;Emoji from AnimalService: {{animal.emoji}} (🐶)&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">      &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">/#VIEW&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-child</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">  &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">/#VIEW&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-root</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span></code></pre>
    </pre>
  </div><p>与 <code>FlowerService</code> 范例一样，<code>AnimalService</code> 在 <code>&lt;app-child&gt;</code> <code>@Component()</code> 装饰器中提供。
这意味着，由于注入器首先在组件的 <code>ElementInjector</code> 中查找，因此它会找到 <code>AnimalService</code> 的值，即狗 <code><span class="docs-emoji">🐶</span></code>。
它无需继续搜索 <code>ElementInjector</code> 树，也无需搜索 <code>ModuleInjector</code>。</p>

  <h3 id="providers-vs-viewproviders">
    <a href="#providers-vs-viewproviders" class="docs-anchor" tabindex="-1" aria-label="Link to <code>providers</code> vs. <code>viewProviders</code>"><code>providers</code> 与 <code>viewProviders</code></a>
  </h3>
  <p><code>viewProviders</code> 字段在概念上类似于 <code>providers</code>，但有一个明显的区别。
<code>viewProviders</code> 中配置的提供者对于最终成为组件逻辑子项的投影内容不可见。</p>
<p>要查看使用 <code>providers</code> 和 <code>viewProviders</code> 之间的区别，请向范例添加另一个组件并将其命名为 <code>InspectorComponent</code>。
<code>InspectorComponent</code> 将是 <code>ChildComponent</code> 的子组件。
在 <code>inspector.component.ts</code> 中，在属性初始化期间注入 <code>FlowerService</code> 和 <code>AnimalService</code>：</p>
<div class="docs-code" header="src/app/inspector/inspector.component.ts">
    <div class="docs-code-header"><h3>src/app/inspector/inspector.component.ts</h3></div>
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> InspectorComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">  flower</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> inject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(FlowerService);</span></span><span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">  animal</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> inject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(AnimalService);</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
    </pre>
  </div><p>你不需要 <code>providers</code> 或 <code>viewProviders</code> 数组。
接下来，在 <code>inspector.component.html</code> 中，添加与先前组件相同的标记：</p>
<div class="docs-code" header="src/app/inspector/inspector.component.html">
    <div class="docs-code-header"><h3>src/app/inspector/inspector.component.html</h3></div>
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;Emoji from FlowerService: {{flower.emoji}}&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;Emoji from AnimalService: {{animal.emoji}}&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span></code></pre>
    </pre>
  </div><p>请记住将 <code>InspectorComponent</code> 添加到 <code>ChildComponent</code> 的 <code>imports</code> 数组中。</p>
<div class="docs-code" header="src/app/child/child.component.ts">
    <div class="docs-code-header"><h3>src/app/child/child.component.ts</h3></div>
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Component</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">({</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  ...</span></span><span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  imports: [InspectorComponent]</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">})</span></span></code></pre>
    </pre>
  </div><p>接下来，将以下内容添加到 <code>child.component.html</code>：</p>
<div class="docs-code" header="src/app/child/child.component.html">
    <div class="docs-code-header"><h3>src/app/child/child.component.html</h3></div>
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">...</span></span><span class="line"></span><span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">div</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> class</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"container"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">h3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;Content projection&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">h3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">ng-content</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">ng-content</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">h3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;Inside the view&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">h3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line highlighted"></span><span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-inspector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-inspector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span></code></pre>
    </pre>
  </div><p><code>&lt;ng-content&gt;</code> 允许你投影内容，而 <code>ChildComponent</code> 模板内的 <code>&lt;app-inspector&gt;</code> 使 <code>InspectorComponent</code> 成为 <code>ChildComponent</code> 的子组件。</p>
<p>接下来，将以下内容添加到 <code>app.component.html</code> 以利用内容投影。</p>
<div class="docs-code" header="src/app/app.component.html">
    <div class="docs-code-header"><h3>src/app/app.component.html</h3></div>
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-child</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-inspector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-inspector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-child</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span></code></pre>
    </pre>
  </div><p>现在，浏览器渲染以下内容，为简洁起见，省略了之前的示例：</p>
<div class="docs-code shell">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">...</span></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Content</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> projection</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Emoji</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> FlowerService:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 🌻</span></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Emoji</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> AnimalService:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 🐳</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Emoji</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> FlowerService:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 🌻</span></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Emoji</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> AnimalService:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 🐶</span></span></code></pre>
    </pre>
  </div><p>这四个绑定演示了 <code>providers</code> 和 <code>viewProviders</code> 之间的区别。
请记住，小狗表情符号 <code><span class="docs-emoji">🐶</span></code> 在 <code>ChildComponent</code> 的 <code>&lt;#VIEW&gt;</code> 内部声明，并且对于投影内容是不可见的。
相反，投影内容看到的是鲸鱼 <code><span class="docs-emoji">🐳</span></code>。</p>
<p>然而，在接下来的输出部分中，尽管 <code>InspectorComponent</code> 是 <code>ChildComponent</code> 的实际子组件，但 <code>InspectorComponent</code> 位于 <code>&lt;#VIEW&gt;</code> 内部，因此当它请求 <code>AnimalService</code> 时，它会看到小狗 <code><span class="docs-emoji">🐶</span></code>。</p>
<p>逻辑树中的 <code>AnimalService</code> 看起来会像这样：</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-root</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> @ApplicationConfig</span></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">         @Inject(AnimalService)</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> animal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">=&gt;"🐳"&gt;</span></span><span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">  &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">#VIEW&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-child</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">      &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">#VIEW @Provide(AnimalService="🐶")</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            @Inject(AnimalService=&gt;"🐶")&gt;</span></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">        &lt;!-- ^^using viewProviders means AnimalService is available in &lt;#VIEW&gt;--&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;Emoji from AnimalService: {{animal.emoji}} (🐶)&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">div</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> class</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"container"</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">          &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">h3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;Content projection&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">h3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">          &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-inspector</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> @Inject(AnimalService)</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> animal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">=&gt;"🐳"&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;Emoji from AnimalService: {{animal.emoji}} (🐳)&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">          &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-inspector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-inspector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">          &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">#VIEW @Inject(AnimalService) animal=&gt;"🐶"&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;Emoji from AnimalService: {{animal.emoji}} (🐶)&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">          &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">/#VIEW&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-inspector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">      &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">/#VIEW&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-child</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">  &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">/#VIEW&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-root</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span></code></pre>
    </pre>
  </div><p><code>&lt;app-inspector&gt;</code> 的投影内容看到的是鲸鱼 <code><span class="docs-emoji">🐳</span></code>，而不是小狗 <code><span class="docs-emoji">🐶</span></code>，因为小狗 <code><span class="docs-emoji">🐶</span></code> 在 <code>&lt;app-child&gt;</code> 的 <code>&lt;#VIEW&gt;</code> 内部。
只有当 <code>&lt;app-inspector&gt;</code> 也位于 <code>&lt;#VIEW&gt;</code> 中时，它才能看到小狗 <code><span class="docs-emoji">🐶</span></code>。</p>

  <h3 id="visibility-of-provided-tokens">
    <a href="#visibility-of-provided-tokens" class="docs-anchor" tabindex="-1" aria-label="Link to Visibility of provided tokens">所提供令牌的可见性</a>
  </h3>
  <p>可见性装饰器会影响在逻辑树中，对注入令牌的搜索从哪里开始以及在哪里结束。
为此，请将可见性配置放在注入点，即调用 <code>inject()</code> 时，而不是在对象声明点。</p>
<p>要更改注入器开始查找 <code>FlowerService</code> 的位置，请将 <code>skipSelf</code> 添加到 <code>&lt;app-child&gt;</code> 的 <code>inject()</code> 调用中，在该调用中注入了 <code>FlowerService</code>。
此调用是 <code>&lt;app-child&gt;</code> 的属性初始化器，如 <code>child.component.ts</code> 中所示：</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">flower </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> inject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(FlowerService, { skipSelf: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> })</span></span></code></pre>
    </pre>
  </div><p>使用 <code>skipSelf</code>，<code>&lt;app-child&gt;</code> 注入器不会在自身中查找 <code>FlowerService</code>。
相反，注入器开始在 <code>&lt;app-root&gt;</code> 的 <code>ElementInjector</code> 中查找 <code>FlowerService</code>，但一无所获。
然后，它返回到 <code>&lt;app-child&gt;</code> 的 <code>ModuleInjector</code> 并找到红色芙蓉花 <code><span class="docs-emoji">🌺</span></code> 值，该值可用，因为 <code>&lt;app-child&gt;</code> 和 <code>&lt;app-root&gt;</code> 共享同一个 <code>ModuleInjector</code>。
UI 渲染以下内容：</p>
<div class="docs-code shell">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Emoji</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> FlowerService:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> 🌺</span></span></code></pre>
    </pre>
  </div><p>在逻辑树中，相同的概念可能看起来像这样：</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-root</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> @ApplicationConfig</span></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">        @Inject(FlowerService)</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> flower</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">=&gt;"🌺"&gt;</span></span><span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">  &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">#VIEW&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-child</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> @Provide(FlowerService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"🌻"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">)</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">      &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">#VIEW @Inject(FlowerService, SkipSelf)=&gt;"🌺"&gt;</span></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">        &lt;!-- With SkipSelf, the injector looks to the next injector up the tree (app-root) --&gt;</span></span><span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">      &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">/#VIEW&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-child</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">  &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">/#VIEW&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-root</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span></code></pre>
    </pre>
  </div><p>尽管 <code>&lt;app-child&gt;</code> 提供了向日葵 <code><span class="docs-emoji">🌻</span></code>，但应用渲染的是红色芙蓉花 <code><span class="docs-emoji">🌺</span></code>，因为 <code>skipSelf</code> 导致当前注入器 (<code>app-child</code>) 跳过自身并查找其父级。</p>
<p>如果现在添加 <code>host</code>（除了 <code>skipSelf</code> 之外），结果将为 <code>null</code>。
这是因为 <code>host</code> 将搜索的上限限制为 <code>app-child</code> 的 <code>&lt;#VIEW&gt;</code>。
以下是逻辑树中的概念：</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-root</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> @ApplicationConfig</span></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">        @Inject(FlowerService)</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> flower</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">=&gt;"🌺"&gt;</span></span><span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">  &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">#VIEW&gt; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">&lt;!-- end search here with null--&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-child</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> @Provide(FlowerService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">"🌻"</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">)</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">&lt;!-- start search here --&gt;</span></span><span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">      &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">#VIEW inject(FlowerService, {skipSelf: true, host: true, optional:true})=&gt;null&gt;</span></span><span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">      &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">/#VIEW&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-parent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">  &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">/#VIEW&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-root</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span></code></pre>
    </pre>
  </div><p>这里，服务及其值是相同的，但是 <code>host</code> 阻止注入器在 <code>&lt;#VIEW&gt;</code> 之外进一步查找 <code>FlowerService</code>，因此它找不到并返回 <code>null</code>。</p>

  <h3 id="skipself-and-viewproviders">
    <a href="#skipself-and-viewproviders" class="docs-anchor" tabindex="-1" aria-label="Link to <code>skipSelf</code> and <code>viewProviders</code>"><code>skipSelf</code> 和 <code>viewProviders</code></a>
  </h3>
  <p>请记住，<code>&lt;app-child&gt;</code> 在 <code>viewProviders</code> 数组中提供了 <code>AnimalService</code>，其值为小狗 <code><span class="docs-emoji">🐶</span></code>。
由于注入器只需要查看 <code>&lt;app-child&gt;</code> 的 <code>ElementInjector</code> 以查找 <code>AnimalService</code>，因此它永远不会看到鲸鱼 <code><span class="docs-emoji">🐳</span></code>。</p>
<p>与 <code>FlowerService</code> 示例中一样，如果将 <code>skipSelf</code> 添加到 <code>AnimalService</code> 的 <code>inject()</code> 中，则注入器将不会在当前 <code>&lt;app-child&gt;</code> 的 <code>ElementInjector</code> 中查找 <code>AnimalService</code>。
相反，注入器将从 <code>&lt;app-root&gt;</code> 的 <code>ElementInjector</code> 开始。</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Component</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">({</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  selector: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'app-child'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  …</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  viewProviders: [</span></span><span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    { provide: AnimalService, useValue: { emoji: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'🐶'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> } },</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  ],</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">})</span></span></code></pre>
    </pre>
  </div><p>在 <code>&lt;app-child&gt;</code> 中使用 <code>skipSelf</code> 时，逻辑树看起来像这样：</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-root</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> @ApplicationConfig</span></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">          @Inject(AnimalService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">=&gt;"🐳")&gt;</span></span><span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">  &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">#VIEW&gt;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">&lt;!-- search begins here --&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-child</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">      &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">#VIEW @Provide(AnimalService="🐶")</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">             @Inject(AnimalService, SkipSelf=&gt;"🐳")&gt;</span></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">        &lt;!--Add skipSelf --&gt;</span></span><span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">      &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">/#VIEW&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-child</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">  &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">/#VIEW&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-root</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span></code></pre>
    </pre>
  </div><p>在 <code>&lt;app-child&gt;</code> 中使用 <code>skipSelf</code> 时，注入器开始在 <code>&lt;app-root&gt;</code> 的 <code>ElementInjector</code> 中搜索 <code>AnimalService</code>，并找到鲸鱼 <code><span class="docs-emoji">🐳</span></code>。</p>

  <h3 id="host-and-viewproviders">
    <a href="#host-and-viewproviders" class="docs-anchor" tabindex="-1" aria-label="Link to <code>host</code> and <code>viewProviders</code>"><code>host</code> 和 <code>viewProviders</code></a>
  </h3>
  <p>如果你只使用 <code>host</code> 来注入 <code>AnimalService</code>，结果是小狗 <code><span class="docs-emoji">🐶</span></code>，因为注入器在 <code>&lt;app-child&gt;</code> 的 <code>&lt;#VIEW&gt;</code> 本身中找到了 <code>AnimalService</code>。
<code>ChildComponent</code> 配置了 <code>viewProviders</code>，以便将小狗表情符号作为 <code>AnimalService</code> 值提供。
你还可以看到 <code>host</code> 的 <code>inject()</code>：</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Component</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">({</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  selector: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'app-child'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  …</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  viewProviders: [</span></span><span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    { provide: AnimalService, useValue: { emoji: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'🐶'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> } },</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  ]</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">})</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> ChildComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span class="line highlighted"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">  animal</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> inject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(AnimalService, { host: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> })</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
    </pre>
  </div><p><code>host: true</code> 导致注入器一直查找，直到遇到 <code>&lt;#VIEW&gt;</code> 的边缘。</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-root</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> @ApplicationConfig</span></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">          @Inject(AnimalService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">=&gt;"🐳")&gt;</span></span><span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">  &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">#VIEW&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-child</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">      &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">#VIEW @Provide(AnimalService="🐶")</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">             inject(AnimalService, {host: true}=&gt;"🐶")&gt; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">&lt;!-- host stops search here --&gt;</span></span><span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">      &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">/#VIEW&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-child</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">  &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">/#VIEW&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-root</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span></code></pre>
    </pre>
  </div><p>将包含第三种动物——刺猬 <code><span class="docs-emoji">🦔</span></code> 的 <code>viewProviders</code> 数组添加到 <code>app.component.ts</code> 的 <code>@Component()</code> 元数据中：</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Component</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">({</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  selector: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'app-root'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  templateUrl: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'./app.component.html'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  styleUrls: [ </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'./app.component.css'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ],</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  viewProviders: [</span></span><span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    { provide: AnimalService, useValue: { emoji: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'🦔'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> } },</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  ],</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">})</span></span></code></pre>
    </pre>
  </div><p>接下来，将 <code>skipSelf</code> 与 <code>host</code> 一起添加到 <code>child.component.ts</code> 中 <code>AnimalService</code> 注入的 <code>inject()</code> 中。
以下是 <code>animal</code> 属性初始化中的 <code>host</code> 和 <code>skipSelf</code>：</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> ChildComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">  animal</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> inject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(AnimalService, { host: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, skipSelf: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> });</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
    </pre>
  </div><!-- TODO: This requires a rework. It seems not well explained what `viewProviders`/`injectors` is here
  and how `host` works.
 -->

<p>当 <code>host</code> 和 <code>skipSelf</code> 应用于 <code>providers</code> 数组中的 <code>FlowerService</code> 时，结果为 <code>null</code>，因为 <code>skipSelf</code> 在 <code>&lt;app-child&gt;</code> 注入器中开始搜索，但 <code>host</code> 在 <code>&lt;#VIEW&gt;</code> 处停止搜索——那里没有 <code>FlowerService</code>。
在逻辑树中，你可以看到 <code>FlowerService</code> 在 <code>&lt;app-child&gt;</code> 中是可见的，而不是在其 <code>&lt;#VIEW&gt;</code> 中。</p>
<p>但是，在 <code>AppComponent</code> 的 <code>viewProviders</code> 数组中提供的 <code>AnimalService</code> 是可见的。</p>
<p>逻辑树表示显示了原因：</p>
<div class="docs-code">
    
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-root</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> @ApplicationConfig</span></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">        @Inject(AnimalService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">=&gt;"🐳")&gt;</span></span><span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">  &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">#VIEW @Provide(AnimalService="🦔")</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">         @Inject(AnimalService, @Optional)=&gt;"🦔"&gt;</span></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">    &lt;!-- ^^skipSelf starts here,  host stops here^^ --&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-child</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">      &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">#VIEW @Provide(AnimalService="🐶")</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">             inject(AnimalService, {skipSelf:true, host: true, optional: true})=&gt;"🦔"&gt;</span></span><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">               &lt;!-- Add skipSelf ^^--&gt;</span></span><span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">      &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">/#VIEW&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">      &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-child</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span><span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic">  &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">/#VIEW&gt;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D">app-root</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;</span></span></code></pre>
    </pre>
  </div><p><code>skipSelf</code> 导致注入器在 <code>&lt;app-root&gt;</code> 而不是请求发起的 <code>&lt;app-child&gt;</code> 处开始搜索 <code>AnimalService</code>，而 <code>host</code> 会在 <code>&lt;app-root&gt;</code> <code>&lt;#VIEW&gt;</code> 处停止搜索。
由于 <code>AnimalService</code> 是通过 <code>viewProviders</code> 数组提供的，因此注入器在 <code>&lt;#VIEW&gt;</code> 中找到了 hedgehog <code><span class="docs-emoji">🦔</span></code>。</p>

  <h2 id="example-elementinjector-use-cases">
    <a href="#example-elementinjector-use-cases" class="docs-anchor" tabindex="-1" aria-label="Link to Example: <code>ElementInjector</code> use cases">范例：<code>ElementInjector</code> 用例</a>
  </h2>
  <p>在不同级别配置一个或多个提供者的能力开辟了有用的可能性。</p>

  <h3 id="scenario-service-isolation">
    <a href="#scenario-service-isolation" class="docs-anchor" tabindex="-1" aria-label="Link to Scenario: service isolation">场景：服务隔离</a>
  </h3>
  <p>架构方面的原因可能会导致你限制对服务的访问，使其只能在它所属的应用域内访问。
例如，假设我们构建了一个 <code>VillainsListComponent</code>，用于显示恶棍列表。
它从 <code>VillainsService</code> 获取这些恶棍。</p>
<p>如果在根 <code>AppModule</code> 中提供 <code>VillainsService</code>，它将使 <code>VillainsService</code> 在应用的任何地方都可见。
如果你稍后修改 <code>VillainsService</code>，你可能会破坏其他组件中的某些内容，这些组件可能在不经意间开始依赖此服务。</p>
<p>相反，你应该像这样在 <code>VillainsListComponent</code> 的 <code>providers</code> 元数据中提供 <code>VillainsService</code>：</p>
<div class="docs-code" header="src/app/villains-list.component.ts (metadata)">
    <div class="docs-code-header"><h3>src/app/villains-list.component.ts (元数据)</h3></div>
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Component</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">({</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  selector: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'app-villains-list'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  templateUrl: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'./villains-list.component.html'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span><span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  providers: [VillainsService]</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">})</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> VillainsListComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {}</span></span></code></pre>
    </pre>
  </div><p>通过在 <code>VillainsListComponent</code> 元数据中提供 <code>VillainsService</code> 且不在其他任何地方提供，该服务仅在 <code>VillainsListComponent</code> 及其子组件树中可用。</p>
<p><code>VillainService</code> 相对于 <code>VillainsListComponent</code> 是单例的，因为正是在那里声明的。
只要 <code>VillainsListComponent</code> 没有被销毁，它将是 <code>VillainService</code> 的同一个实例，但是如果存在 <code>VillainsListComponent</code> 的多个实例，则 <code>VillainsListComponent</code> 的每个实例都将拥有自己的 <code>VillainService</code> 实例。</p>

  <h3 id="scenario-multiple-edit-sessions">
    <a href="#scenario-multiple-edit-sessions" class="docs-anchor" tabindex="-1" aria-label="Link to Scenario: multiple edit sessions">场景：多个编辑会话</a>
  </h3>
  <p>许多应用允许用户同时处理多个打开的任务。
例如，在税务准备应用中，准备人员可以处理多个纳税申报表，并在一天中在它们之间切换。</p>
<p>为了演示该场景，请想象一个 <code>HeroListComponent</code>，它显示超级英雄的列表。</p>
<p>要打开英雄的纳税申报表，准备人员单击英雄姓名，这将打开一个组件来编辑该申报表。
每个选定的英雄纳税申报表都在其自己的组件中打开，并且可以同时打开多个申报表。</p>
<p>每个纳税申报表组件都具有以下特征：</p>

  <ul class="docs-list">
    <li>是其自己的纳税申报表编辑会话</li>
<li>可以更改纳税申报表，而不会影响另一个组件中的申报表</li>
<li>能够保存对其纳税申报表的更改或取消它们</li>

  </ul>
  <p>假设 <code>HeroTaxReturnComponent</code> 具有管理和恢复更改的逻辑。
对于英雄纳税申报表来说，这将是一项简单的任务。
但在现实世界中，对于具有丰富纳税申报表数据模型的应用，变更管理将非常棘手。
你可以将该管理委托给辅助服务，如本例所示。</p>
<p><code>HeroTaxReturnService</code> 缓存单个 <code>HeroTaxReturn</code>，跟踪对该申报表的更改，并且可以保存或恢复它。
它还委托给应用范围内的单例 <code>HeroService</code>，它通过依赖注入获得该服务。</p>
<div class="docs-code" header="src/app/hero-tax-return.service.ts">
    <div class="docs-code-header"><h3>src/app/hero-tax-return.service.ts</h3></div>
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> { Injectable } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '@angular/core'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> { HeroTaxReturn } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> './hero'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> { HeroesService } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> './heroes.service'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Injectable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">()</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> HeroTaxReturnService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  private</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70"> currentTaxReturn</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">!:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> HeroTaxReturn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  private</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70"> originalTaxReturn</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">!:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> HeroTaxReturn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  private</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70"> heroService</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> inject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(HeroesService);</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  set</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> taxReturn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">htr</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> HeroTaxReturn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) {</span></span><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.originalTaxReturn </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> htr;</span></span><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.currentTaxReturn  </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> htr.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">clone</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">();</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  }</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  get</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> taxReturn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> HeroTaxReturn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.currentTaxReturn;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  }</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  restoreTaxReturn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">() {</span></span><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.taxReturn </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.originalTaxReturn;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  }</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  saveTaxReturn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">() {</span></span><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.taxReturn </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.currentTaxReturn;</span></span><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.heroService.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">saveTaxReturn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.currentTaxReturn).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">subscribe</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">();</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  }</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
    </pre>
  </div><p>这是使用 <code>HeroTaxReturnService</code> 的 <code>HeroTaxReturnComponent</code>。</p>
<div class="docs-code" header="src/app/hero-tax-return.component.ts">
    <div class="docs-code-header"><h3>src/app/hero-tax-return.component.ts</h3></div>
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> { Component, EventEmitter, Input, Output } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> '@angular/core'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> { HeroTaxReturn } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> './hero'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> { HeroTaxReturnService } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> './hero-tax-return.service'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">@</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Component</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">({</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  selector: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'app-hero-tax-return'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  templateUrl: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'./hero-tax-return.component.html'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  styleUrls: [ </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'./hero-tax-return.component.css'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ],</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  providers: [ HeroTaxReturnService ]</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">})</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> HeroTaxReturnComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">  message</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ''</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">;</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  @</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Output</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">() </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">close</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> EventEmitter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">&gt;();</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  get</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> taxReturn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> HeroTaxReturn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> {</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.heroTaxReturnService.taxReturn;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  }</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  @</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">Input</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">()</span></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  set</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> taxReturn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">htr</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> HeroTaxReturn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) {</span></span><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.heroTaxReturnService.taxReturn </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> htr;</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  }</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">  private</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70"> heroTaxReturnService</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0"> inject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(HeroTaxReturnService);</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  onCanceled</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">()  {</span></span><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">flashMessage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'Canceled'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.heroTaxReturnService.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">restoreTaxReturn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">();</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  }</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  onClose</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">() { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.close.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">emit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(); }</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  onSaved</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">() {</span></span><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">flashMessage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">'Saved'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.heroTaxReturnService.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">saveTaxReturn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">();</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  }</span></span><span class="line"></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">  flashMessage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70">msg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) {</span></span><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.message </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> msg;</span></span><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">    setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.message </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> ''</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">500</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">);</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">  }</span></span><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">}</span></span></code></pre>
    </pre>
  </div><p><em>要编辑的纳税申报表</em> 通过 <code>@Input()</code> 属性传入，该属性使用 getter 和 setter 实现。
Setter 使用传入的申报表初始化组件自身 <code>HeroTaxReturnService</code> 的实例。
Getter 始终返回该服务所说的英雄的当前状态。
该组件还要求该服务保存和恢复此纳税申报表。</p>
<p>如果该服务是应用范围内的单例，这将不起作用。
每个组件都将共享同一个服务实例，并且每个组件都将覆盖属于另一个英雄的纳税申报表。</p>
<p>为了防止这种情况，请配置 <code>HeroTaxReturnComponent</code> 的组件级注入器以提供该服务，方法是在组件元数据中使用 <code>providers</code> 属性。</p>
<div class="docs-code" header="src/app/hero-tax-return.component.ts (providers)">
    <div class="docs-code-header"><h3>src/app/hero-tax-return.component.ts (提供者)</h3></div>
    <pre class="docs-mini-scroll-track">      <pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0">providers</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">: [HeroTaxReturnService]</span></span></code></pre>
    </pre>
  </div><p><code>HeroTaxReturnComponent</code> 组件有自己的 <code>HeroTaxReturnService</code> 提供者。
回想一下，每个组件<em>实例</em>都有自己的注入器。
在组件级别提供此服务可确保组件的<em>每个</em>实例都获得该服务的私有实例。这样可以确保不会覆盖任何纳税申报表。</p>

    <div class="docs-alert docs-alert-helpful">
    <p><strong>提示：</strong> 场景代码的其余部分依赖于其他 Angular 特性和技术，你可以在文档的其他地方了解它们。</p>

    </div>
    
  <h3 id="scenario-specialized-providers">
    <a href="#scenario-specialized-providers" class="docs-anchor" tabindex="-1" aria-label="Link to Scenario: specialized providers">场景：专用提供者</a>
  </h3>
  <p>在另一个级别再次提供服务的另一个原因是，为了在组件树的更深层替换该服务的<em>更专用</em>实现。</p>
<p>例如，考虑一个 <code>Car</code> 组件，它包含轮胎服务信息，并依赖于其他服务来提供关于汽车的更多详情。</p>
<p>根注入器（标记为 A）对关于 <code>CarService</code> 和 <code>EngineService</code> 的详情使用了<em>通用</em>提供者。</p>

    <ol class="docs-ordered-list">
      <li><p><code>Car</code> 组件 (A)。组件 (A) 显示关于汽车的轮胎服务数据，并指定通用服务以提供关于汽车的更多信息。</p>
</li>
<li><p>子组件 (B)。组件 (B) 为 <code>CarService</code> 和 <code>EngineService</code> 定义了自己的<em>专用</em>提供者，这些提供者具有适用于组件 (B) 中正在发生的事情的特殊功能。</p>
</li>
<li><p>子组件 (C) 作为组件 (B) 的子组件。组件 (C) 为 <code>CarService</code> 定义了它自己的，甚至<em>更专用</em>的提供者。</p>
</li>

    </ol>
    <svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 355.15625 215" style="max-width: 355.15625px;" class="flowchart" xmlns="http://www.w3.org/2000/svg" width="100%" id="mermaid-generated-diagram"><style>#mermaid-generated-diagram{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}@keyframes edge-animation-frame{from{stroke-dashoffset:0;}}@keyframes dash{to{stroke-dashoffset:0;}}#mermaid-generated-diagram .edge-animation-slow{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 50s linear infinite;stroke-linecap:round;}#mermaid-generated-diagram .edge-animation-fast{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 20s linear infinite;stroke-linecap:round;}#mermaid-generated-diagram .error-icon{fill:hsl(220.5882352941, 100%, 98.3333333333%);}#mermaid-generated-diagram .error-text{fill:rgb(8.5000000002, 5.7500000001, 0);stroke:rgb(8.5000000002, 5.7500000001, 0);}#mermaid-generated-diagram .edge-thickness-normal{stroke-width:1px;}#mermaid-generated-diagram .edge-thickness-thick{stroke-width:3.5px;}#mermaid-generated-diagram .edge-pattern-solid{stroke-dasharray:0;}#mermaid-generated-diagram .edge-thickness-invisible{stroke-width:0;fill:none;}#mermaid-generated-diagram .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-generated-diagram .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-generated-diagram .marker{fill:#0b0b0b;stroke:#0b0b0b;}#mermaid-generated-diagram .marker.cross{stroke:#0b0b0b;}#mermaid-generated-diagram svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-generated-diagram p{margin:0;}#mermaid-generated-diagram .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#mermaid-generated-diagram .cluster-label text{fill:rgb(8.5000000002, 5.7500000001, 0);}#mermaid-generated-diagram .cluster-label span{color:rgb(8.5000000002, 5.7500000001, 0);}#mermaid-generated-diagram .cluster-label span p{background-color:transparent;}#mermaid-generated-diagram .label text,#mermaid-generated-diagram span{fill:#333;color:#333;}#mermaid-generated-diagram .node rect,#mermaid-generated-diagram .node circle,#mermaid-generated-diagram .node ellipse,#mermaid-generated-diagram .node polygon,#mermaid-generated-diagram .node path{fill:#fff4dd;stroke:hsl(40.5882352941, 60%, 83.3333333333%);stroke-width:1px;}#mermaid-generated-diagram .rough-node .label text,#mermaid-generated-diagram .node .label text,#mermaid-generated-diagram .image-shape .label,#mermaid-generated-diagram .icon-shape .label{text-anchor:middle;}#mermaid-generated-diagram .node .katex path{fill:#000;stroke:#000;stroke-width:1px;}#mermaid-generated-diagram .rough-node .label,#mermaid-generated-diagram .node .label,#mermaid-generated-diagram .image-shape .label,#mermaid-generated-diagram .icon-shape .label{text-align:center;}#mermaid-generated-diagram .node.clickable{cursor:pointer;}#mermaid-generated-diagram .root .anchor path{fill:#0b0b0b!important;stroke-width:0;stroke:#0b0b0b;}#mermaid-generated-diagram .arrowheadPath{fill:#0b0b0b;}#mermaid-generated-diagram .edgePath .path{stroke:#0b0b0b;stroke-width:2.0px;}#mermaid-generated-diagram .flowchart-link{stroke:#0b0b0b;fill:none;}#mermaid-generated-diagram .edgeLabel{background-color:hsl(-79.4117647059, 100%, 93.3333333333%);text-align:center;}#mermaid-generated-diagram .edgeLabel p{background-color:hsl(-79.4117647059, 100%, 93.3333333333%);}#mermaid-generated-diagram .edgeLabel rect{opacity:0.5;background-color:hsl(-79.4117647059, 100%, 93.3333333333%);fill:hsl(-79.4117647059, 100%, 93.3333333333%);}#mermaid-generated-diagram .labelBkg{background-color:rgba(243.9999999999, 220.9999999998, 255, 0.5);}#mermaid-generated-diagram .cluster rect{fill:hsl(220.5882352941, 100%, 98.3333333333%);stroke:hsl(220.5882352941, 60%, 88.3333333333%);stroke-width:1px;}#mermaid-generated-diagram .cluster text{fill:rgb(8.5000000002, 5.7500000001, 0);}#mermaid-generated-diagram .cluster span{color:rgb(8.5000000002, 5.7500000001, 0);}#mermaid-generated-diagram div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(220.5882352941, 100%, 98.3333333333%);border:1px solid hsl(220.5882352941, 60%, 88.3333333333%);border-radius:2px;pointer-events:none;z-index:100;}#mermaid-generated-diagram .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333;}#mermaid-generated-diagram rect.text{fill:none;stroke-width:0;}#mermaid-generated-diagram .icon-shape,#mermaid-generated-diagram .image-shape{background-color:hsl(-79.4117647059, 100%, 93.3333333333%);text-align:center;}#mermaid-generated-diagram .icon-shape p,#mermaid-generated-diagram .image-shape p{background-color:hsl(-79.4117647059, 100%, 93.3333333333%);padding:2px;}#mermaid-generated-diagram .icon-shape rect,#mermaid-generated-diagram .image-shape rect{opacity:0.5;background-color:hsl(-79.4117647059, 100%, 93.3333333333%);fill:hsl(-79.4117647059, 100%, 93.3333333333%);}#mermaid-generated-diagram :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}#mermaid-generated-diagram .noShadow>*{filter:none!important;}#mermaid-generated-diagram .noShadow span{filter:none!important;}</style><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid-generated-diagram_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid-generated-diagram_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid-generated-diagram_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid-generated-diagram_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid-generated-diagram_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid-generated-diagram_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"></g><g class="edgeLabels"></g><g class="nodes"><g transform="translate(0, 0)" class="root"><g class="clusters"><g data-look="classic" id="COMPONENT_A" class="cluster noShadow"><rect height="199" width="339.15625" y="8" x="8" style="filter:none !important;fill:#BDD7EE !important"></rect><g transform="translate(123.1171875, 8)" class="cluster-label"><foreignObject height="24" width="108.921875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Component A</p></span></div></foreignObject></g></g></g><g class="edgePaths"></g><g class="edgeLabels"></g><g class="nodes"><g transform="translate(35, 37.5)" class="root"><g class="clusters"><g data-look="classic" id="COMPONENT_B" class="cluster noShadow"><rect height="124" width="269.15625" y="8" x="8" style="filter:none !important;fill:#FFE699 !important"></rect><g transform="translate(88.1015625, 8)" class="cluster-label"><foreignObject height="24" width="108.953125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Component B</p></span></div></foreignObject></g></g></g><g class="edgePaths"></g><g class="edgeLabels"></g><g class="nodes"><g transform="translate(142.578125, 70)" id="flowchart-COMPONENT_C-0" class="node default noShadow"><rect height="54" width="169.15625" y="-27" x="-84.578125" style="filter:none !important;fill:#A9D18E !important" class="basic label-container"></rect><g transform="translate(-54.578125, -12)" style="color:#000 !important" class="label"><rect></rect><foreignObject height="24" width="109.15625"><div xmlns="http://www.w3.org/1999/xhtml" style="color: rgb(0, 0, 0) !important; display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel" style="color:#000 !important"><p>Component C</p></span></div></foreignObject></g></g></g></g></g></g></g></g></g></svg><p>在幕后，每个组件都建立了自己的注入器，其中包含为该组件自身定义的零个、一个或多个提供者。</p>
<p>当你在最深层的组件 (C) 中求解 <code>Car</code> 的实例时，它的注入器会产生：</p>

  <ul class="docs-list">
    <li>由注入器 (C) 求解的 <code>Car</code> 实例</li>
<li>由注入器 (B) 求解的 <code>Engine</code></li>
<li>它的 <code>Tires</code> 由根注入器 (A) 求解。</li>

  </ul>
  <svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 596.359375 604" style="max-width: 596.359375px;" class="flowchart" xmlns="http://www.w3.org/2000/svg" width="100%" id="mermaid-generated-diagram"><style>#mermaid-generated-diagram{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}@keyframes edge-animation-frame{from{stroke-dashoffset:0;}}@keyframes dash{to{stroke-dashoffset:0;}}#mermaid-generated-diagram .edge-animation-slow{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 50s linear infinite;stroke-linecap:round;}#mermaid-generated-diagram .edge-animation-fast{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 20s linear infinite;stroke-linecap:round;}#mermaid-generated-diagram .error-icon{fill:hsl(220.5882352941, 100%, 98.3333333333%);}#mermaid-generated-diagram .error-text{fill:rgb(8.5000000002, 5.7500000001, 0);stroke:rgb(8.5000000002, 5.7500000001, 0);}#mermaid-generated-diagram .edge-thickness-normal{stroke-width:1px;}#mermaid-generated-diagram .edge-thickness-thick{stroke-width:3.5px;}#mermaid-generated-diagram .edge-pattern-solid{stroke-dasharray:0;}#mermaid-generated-diagram .edge-thickness-invisible{stroke-width:0;fill:none;}#mermaid-generated-diagram .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-generated-diagram .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-generated-diagram .marker{fill:#0b0b0b;stroke:#0b0b0b;}#mermaid-generated-diagram .marker.cross{stroke:#0b0b0b;}#mermaid-generated-diagram svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-generated-diagram p{margin:0;}#mermaid-generated-diagram .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#mermaid-generated-diagram .cluster-label text{fill:rgb(8.5000000002, 5.7500000001, 0);}#mermaid-generated-diagram .cluster-label span{color:rgb(8.5000000002, 5.7500000001, 0);}#mermaid-generated-diagram .cluster-label span p{background-color:transparent;}#mermaid-generated-diagram .label text,#mermaid-generated-diagram span{fill:#333;color:#333;}#mermaid-generated-diagram .node rect,#mermaid-generated-diagram .node circle,#mermaid-generated-diagram .node ellipse,#mermaid-generated-diagram .node polygon,#mermaid-generated-diagram .node path{fill:#fff4dd;stroke:hsl(40.5882352941, 60%, 83.3333333333%);stroke-width:1px;}#mermaid-generated-diagram .rough-node .label text,#mermaid-generated-diagram .node .label text,#mermaid-generated-diagram .image-shape .label,#mermaid-generated-diagram .icon-shape .label{text-anchor:middle;}#mermaid-generated-diagram .node .katex path{fill:#000;stroke:#000;stroke-width:1px;}#mermaid-generated-diagram .rough-node .label,#mermaid-generated-diagram .node .label,#mermaid-generated-diagram .image-shape .label,#mermaid-generated-diagram .icon-shape .label{text-align:center;}#mermaid-generated-diagram .node.clickable{cursor:pointer;}#mermaid-generated-diagram .root .anchor path{fill:#0b0b0b!important;stroke-width:0;stroke:#0b0b0b;}#mermaid-generated-diagram .arrowheadPath{fill:#0b0b0b;}#mermaid-generated-diagram .edgePath .path{stroke:#0b0b0b;stroke-width:2.0px;}#mermaid-generated-diagram .flowchart-link{stroke:#0b0b0b;fill:none;}#mermaid-generated-diagram .edgeLabel{background-color:hsl(-79.4117647059, 100%, 93.3333333333%);text-align:center;}#mermaid-generated-diagram .edgeLabel p{background-color:hsl(-79.4117647059, 100%, 93.3333333333%);}#mermaid-generated-diagram .edgeLabel rect{opacity:0.5;background-color:hsl(-79.4117647059, 100%, 93.3333333333%);fill:hsl(-79.4117647059, 100%, 93.3333333333%);}#mermaid-generated-diagram .labelBkg{background-color:rgba(243.9999999999, 220.9999999998, 255, 0.5);}#mermaid-generated-diagram .cluster rect{fill:hsl(220.5882352941, 100%, 98.3333333333%);stroke:hsl(220.5882352941, 60%, 88.3333333333%);stroke-width:1px;}#mermaid-generated-diagram .cluster text{fill:rgb(8.5000000002, 5.7500000001, 0);}#mermaid-generated-diagram .cluster span{color:rgb(8.5000000002, 5.7500000001, 0);}#mermaid-generated-diagram div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(220.5882352941, 100%, 98.3333333333%);border:1px solid hsl(220.5882352941, 60%, 88.3333333333%);border-radius:2px;pointer-events:none;z-index:100;}#mermaid-generated-diagram .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333;}#mermaid-generated-diagram rect.text{fill:none;stroke-width:0;}#mermaid-generated-diagram .icon-shape,#mermaid-generated-diagram .image-shape{background-color:hsl(-79.4117647059, 100%, 93.3333333333%);text-align:center;}#mermaid-generated-diagram .icon-shape p,#mermaid-generated-diagram .image-shape p{background-color:hsl(-79.4117647059, 100%, 93.3333333333%);padding:2px;}#mermaid-generated-diagram .icon-shape rect,#mermaid-generated-diagram .image-shape rect{opacity:0.5;background-color:hsl(-79.4117647059, 100%, 93.3333333333%);fill:hsl(-79.4117647059, 100%, 93.3333333333%);}#mermaid-generated-diagram :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid-generated-diagram_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid-generated-diagram_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid-generated-diagram_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid-generated-diagram_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid-generated-diagram_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid-generated-diagram_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"><g data-look="classic" id="C" class="cluster noShadow"><rect height="104" width="466.5625" y="388" x="13.3359375" style=""></rect><g transform="translate(246.6171875, 388)" class="cluster-label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"></span></div></foreignObject></g></g><g data-look="classic" id="B" class="cluster noShadow"><rect height="128" width="580.359375" y="210" x="8" style=""></rect><g transform="translate(298.1796875, 210)" class="cluster-label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"></span></div></foreignObject></g></g><g data-look="classic" id="A" class="cluster noShadow"><rect height="152" width="565.359375" y="8" x="15.5" style=""></rect><g transform="translate(298.1796875, 8)" class="cluster-label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#mermaid-generated-diagram_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_car_ChildInjector_0" d="M143.18,542L143.18,537.833C143.18,533.667,143.18,525.333,143.18,517C143.18,508.667,143.18,500.333,143.18,492.667C143.18,485,143.18,478,143.18,474.5L143.18,471"></path><path marker-end="url(#mermaid-generated-diagram_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_ChildInjector_ParentInjector_0" d="M143.18,413L143.18,408.833C143.18,404.667,143.18,396.333,143.18,388C143.18,379.667,143.18,371.333,143.18,363C143.18,354.667,143.18,346.333,143.18,336.667C143.18,327,143.18,316,143.18,310.5L143.18,305"></path><path marker-end="url(#mermaid-generated-diagram_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_ParentInjector_RootInjector_0" d="M143.18,247L143.18,240.833C143.18,234.667,143.18,222.333,143.18,212C143.18,201.667,143.18,193.333,143.18,185C143.18,176.667,143.18,168.333,143.18,156.667C143.18,145,143.18,130,143.18,122.5L143.18,115"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(143.1796875, 84)" id="flowchart-RootInjector-0" class="node default noShadow"><rect height="54" width="185.359375" y="-27" x="-92.6796875" style="fill:#BDD7EE !important" class="basic label-container"></rect><g transform="translate(-62.6796875, -12)" style="color:#000 !important" class="label"><rect></rect><foreignObject height="24" width="125.359375"><div xmlns="http://www.w3.org/1999/xhtml" style="color: rgb(0, 0, 0) !important; display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel" style="color:#000 !important"><p>(A) RootInjector</p></span></div></foreignObject></g></g><g transform="translate(415.859375, 84)" id="flowchart-ServicesA-1" class="node default noShadow"><rect height="102" width="260" y="-51" x="-130" style="" class="basic label-container"></rect><g transform="translate(-100, -36)" style="" class="label"><rect></rect><foreignObject height="72" width="200"><div style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>CarService, EngineService, TiresService</p></span></div></foreignObject></g></g><g transform="translate(143.1796875, 274)" id="flowchart-ParentInjector-2" class="node default noShadow"><rect height="54" width="200.359375" y="-27" x="-100.1796875" style="fill:#FFE699 !important" class="basic label-container"></rect><g transform="translate(-70.1796875, -12)" style="color:#000 !important" class="label"><rect></rect><foreignObject height="24" width="140.359375"><div xmlns="http://www.w3.org/1999/xhtml" style="color: rgb(0, 0, 0) !important; display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel" style="color:#000 !important"><p>(B) ParentInjector</p></span></div></foreignObject></g></g><g transform="translate(423.359375, 274)" id="flowchart-ServicesB-3" class="node default noShadow"><rect height="78" width="260" y="-39" x="-130" style="" class="basic label-container"></rect><g transform="translate(-100, -24)" style="" class="label"><rect></rect><foreignObject height="48" width="200"><div style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>CarService2, EngineService2</p></span></div></foreignObject></g></g><g transform="translate(143.1796875, 440)" id="flowchart-ChildInjector-4" class="node default noShadow"><rect height="54" width="189.6875" y="-27" x="-94.84375" style="fill:#A9D18E !important" class="basic label-container"></rect><g transform="translate(-64.84375, -12)" style="color:#000 !important" class="label"><rect></rect><foreignObject height="24" width="129.6875"><div xmlns="http://www.w3.org/1999/xhtml" style="color: rgb(0, 0, 0) !important; display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel" style="color:#000 !important"><p>(C) ChildInjector</p></span></div></foreignObject></g></g><g transform="translate(366.4609375, 440)" id="flowchart-ServicesC-5" class="node default noShadow"><rect height="54" width="156.875" y="-27" x="-78.4375" style="" class="basic label-container"></rect><g transform="translate(-48.4375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="96.875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>CarService3</p></span></div></foreignObject></g></g><g transform="translate(143.1796875, 569)" id="flowchart-car-6" class="node default noShadow"><rect height="54" width="116.296875" y="-27" x="-58.1484375" style="fill:#A9D18E !important" class="basic label-container"></rect><g transform="translate(-28.1484375, -12)" style="color:#000 !important" class="label"><rect></rect><foreignObject height="24" width="56.296875"><div xmlns="http://www.w3.org/1999/xhtml" style="color: rgb(0, 0, 0) !important; display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel" style="color:#000 !important"><p>(C) Car</p></span></div></foreignObject></g></g><g transform="translate(323.0234375, 569)" id="flowchart-engine-7" class="node default noShadow"><rect height="54" width="143.390625" y="-27" x="-71.6953125" style="fill:#FFE699 !important" class="basic label-container"></rect><g transform="translate(-41.6953125, -12)" style="color:#000 !important" class="label"><rect></rect><foreignObject height="24" width="83.390625"><div xmlns="http://www.w3.org/1999/xhtml" style="color: rgb(0, 0, 0) !important; display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel" style="color:#000 !important"><p>(B) Engine</p></span></div></foreignObject></g></g><g transform="translate(508.046875, 569)" id="flowchart-tires-8" class="node default noShadow"><rect height="54" width="126.65625" y="-27" x="-63.328125" style="fill:#BDD7EE !important" class="basic label-container"></rect><g transform="translate(-33.328125, -12)" style="color:#000 !important" class="label"><rect></rect><foreignObject height="24" width="66.65625"><div xmlns="http://www.w3.org/1999/xhtml" style="color: rgb(0, 0, 0) !important; display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel" style="color:#000 !important"><p>(A) Tires</p></span></div></foreignObject></g></g></g></g></g></svg>
  <h2 id="more-on-dependency-injection">
    <a href="#more-on-dependency-injection" class="docs-anchor" tabindex="-1" aria-label="Link to More on dependency injection">更多关于依赖注入的内容</a>
  </h2>
  
    <nav class="docs-pill-row">
      
    <a class="docs-pill" href="/guide/di/dependency-injection-providers">DI 提供者</a>
    

    </nav>
    